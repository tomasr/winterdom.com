---
layout: post
status: publish
published: true
title: Sending multiple attachments with SMTP Adapter
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 944
wordpress_url: http://winterdom.com/2007/03/sendingmultipleattachmentswithsmtpadapter
date: '2007-03-04 18:43:40 +0000'
date_gmt: '2007-03-04 18:43:40 +0000'
categories:
- BizTalk
tags: []
comments: []
---
<p><!--start_raw-->
<p>I've received a number of questions regarding a sample I posted a while ago: <a href="http:&#47;&#47;www.winterdom.com&#47;weblog&#47;2006&#47;08&#47;17&#47;ArbitraryBinaryAttachmentsToMultiPartMessages.aspx">Arbitrary Binary Attachments to Multi-Part Messages</a>; mostly related to issues when sending the resulting messages through the SMTP adapter and not all attachments (or no attachments at all) getting to the destination account.</p>
<p>I've found that usually, this is the result of setting the SMTP.MessagePartsAttachments property to the wrong value. In the sample I posted alongside the article, I was setting the&nbsp;property&nbsp;to 2. I didn't give any explanation about it at the time, but contrary to what it may intuitively appear, you don't set this property to the number of attachments (parts) you want to send alongside the message.If you attach 4 different parts to the message, you <em>don't set the property</em> to the value 4.</p>
<p>Instead, the value 2 means "Send all parts as attachments", which is exactly the behavior you want. For completeness sake, here's what each possible value for this property means (taken from the <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;aa578155.aspx">BizTalk documentation</a>):</p>
<li>0 - No BizTalk message parts will be used as attachments.
<li>1- The BizTalk message body part is sent as an e-mail attachment. In this case, the <b>EmailBodyFile</b> or <b>EmailBodyText</b> properties should be specified. If neither of these properties are specified, the BizTalk message body part is sent as the e-mail body instead of as an attachment.
<li>2 - All parts are sent as attachments. However, if <b>EmailBodyText</b> or <b>EmailBodyFile</b> are not specified, then the BizTalk message body part is sent as the e-mail body and other parts are sent as attachments.<br></li>
<div class="wlWriterSmartContent" id="0767317B-992E-4b12-91E0-4F059A8CECA8:0758d193-d1fe-4e6d-98e4-16fbd6ca1812" contenteditable="false" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati tags: <a href="http:&#47;&#47;technorati.com&#47;tags&#47;BizTalk%20Server" rel="tag">BizTalk Server</a></div><!--end_raw--></p>
