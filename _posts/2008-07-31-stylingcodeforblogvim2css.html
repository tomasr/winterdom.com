---
layout: post
status: publish
published: true
title: Styling Code for Blog (Vim2Css)
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 726
wordpress_url: http://winterdom.com/2008/07/stylingcodeforblogvim2css
date: '2008-07-31 21:56:32 +0000'
date_gmt: '2008-07-31 21:56:32 +0000'
categories:
- Blogging
- PowerShell
- Vim
tags: []
comments:
- id: 486
  author: Hal Rottenberg
  author_email: hal@halr9000.com
  author_url: http://halr9000.com
  date: '2008-08-01 04:33:39 +0000'
  date_gmt: '2008-08-01 04:33:39 +0000'
  content: |
    Nice! Almost enough to make me want to switch editors. :)
---
<p><!--start_raw-->
<p>I've <a href="&#47;weblog&#47;2008&#47;02&#47;07&#47;FormattingSourceCodeForBlogPosts.aspx">mentioned in the past</a> that I've experimented with a number of different options for styling and syntax highlighting code snippets on this weblog, with varying degrees of success.</p>
<p>For a few months I've been using CSS-based syntax highlighting based on the code generated by Vim's :TOhtml command, and it's been working out pretty well. It means that my <a href="http:&#47;&#47;feeds.feedburner.com&#47;Commonality">RSS feed</a> doesn't have any color, but at least the code itself is correctly formatted.</p>
<p>The part I didn't enjoy too much about :TOhtml, however, was that it would only generate the minimum number of style rules it need to highlight the piece of code it was generating the HTML for. This works fine in many scenarios, but it was annoying for me because it meant I needed to continually update my site code.css file as new rules were generated for new snippets that I didn't have in there before.</p>
<p>So what I really wanted was a way to convert the Vim colorscheme of my choice into a CSS useful for my site. Naturally, I turned to PowerShell and came up with convert-vim2css.ps1:</p>
<div class="codebg"><code><span class="Keyword">param</span>( <span class="Type">[string]</span>&#160;<span class="Identifier">$vimfile</span> )      <br &#47;>      <br &#47;><span class="Comment"># some instructions we don't care for</span>      <br &#47;><span class="Identifier">$ignorable</span> = ( <span class="String">'link'</span>, <span class="String">'clear'</span> )      <br &#47;>      <br &#47;><span class="Identifier">$nrx</span> = <span class="String">'hi (?<n>\w+)'</span>      <br &#47;><span class="Identifier">$fgrx</span> = <span class="String">'guifg=(?<n>#\w+)'</span>      <br &#47;><span class="Identifier">$bgrx</span> = <span class="String">'guibg=(?<n>#\w+)'</span>      <br &#47;><span class="Identifier">$frx</span> = <span class="String">'gui=(?<n>\S+)'</span>      <br &#47;>      <br &#47;>(gc <span class="Identifier">$vimfile</span>) | ?{       <br &#47;>&#160;&#160; (<span class="Identifier">$_</span> -<span class="Operator">match</span>&#160;<span class="Identifier">$nrx</span>) -<span class="Operator">and</span> (<span class="Identifier">$ignorable</span> -<span class="Operator">notcontains</span>&#160;<span class="Identifier">$matches</span>.n)       <br &#47;>} | %{      <br &#47;>&#160;&#160; <span class="Conditional">if</span> ( <span class="Identifier">$matches</span>.n -<span class="Operator">eq</span>&#160;<span class="String">'Normal'</span> ) {      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">'.codebg {'</span>      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">'&#160;&#160; border-left: solid 1em #303030;'</span>      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">'&#160;&#160; font-size: 1.1em;'</span>      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">'&#160;&#160; padding: 0.8em 0.5em;'</span>      <br &#47;>&#160;&#160; } <span class="Conditional">else</span> {      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">".$($matches.n) {"</span>      <br &#47;>&#160;&#160; }      <br &#47;>&#160;&#160; <span class="Conditional">if</span> ( <span class="Identifier">$_</span> -<span class="Operator">match</span>&#160;<span class="Identifier">$fgrx</span> ) {      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">"&#160;&#160; color: $($matches.n);"</span>      <br &#47;>&#160;&#160; }      <br &#47;>&#160;&#160; <span class="Conditional">if</span> ( <span class="Identifier">$_</span> -<span class="Operator">match</span>&#160;<span class="Identifier">$bgrx</span> ) {      <br &#47;>&#160;&#160;&#160;&#160;&#160; write <span class="String">"&#160;&#160; background: $($matches.n);"</span>      <br &#47;>&#160;&#160; }      <br &#47;>&#160;&#160; <span class="Comment"># element could any combination of these</span>      <br &#47;>&#160;&#160; <span class="Conditional">if</span> ( <span class="Identifier">$_</span> -<span class="Operator">match</span>&#160;<span class="Identifier">$frx</span> ) {      <br &#47;>&#160;&#160;&#160;&#160;&#160; <span class="Conditional">switch</span> ( <span class="Identifier">$matches</span>.n.split(<span class="String">','</span>) ) {      <br &#47;>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="String">"italic"</span> { write <span class="String">"&#160;&#160; font-style: $_;"</span> }      <br &#47;>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="String">"bold"</span> { write <span class="String">"&#160;&#160; font-weight: $_;"</span> }      <br &#47;>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="String">"underline"</span> { write <span class="String">"&#160;&#160; text-decoration: $_;"</span> }      <br &#47;>&#160;&#160;&#160;&#160;&#160; }      <br &#47;>&#160;&#160; }      <br &#47;>&#160;&#160; write <span class="String">'}'</span>      <br &#47;>}      <br &#47;>      <br &#47;><span class="Comment"># other boilerplate code</span>      <br &#47;>write <span class="String">'code {'</span>      <br &#47;>write <span class="String">'&#160;&#160; font-family: Consolas, "DejaVu Sans Mono", "Lucida Console", monospace; '</span>      <br &#47;>write <span class="String">'}'</span> </code></div>
<p>It's not very fancy and it only supports GVim schemes, but that's enough for me and does the trick for now.</p>
<div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:31103de6-60b1-4bd3-9b00-492a9296eaaa" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati tags: <a href="http:&#47;&#47;technorati.com&#47;tags&#47;Vim" rel="tag">Vim</a>, <a href="http:&#47;&#47;technorati.com&#47;tags&#47;PowerShell" rel="tag">PowerShell</a></div><!--end_raw--></p>
