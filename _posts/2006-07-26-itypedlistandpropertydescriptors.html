---
layout: post
status: publish
published: true
title: ITypedList and PropertyDescriptors
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 934
wordpress_url: http://winterdom.com/2006/07/itypedlistandpropertydescriptors
date: '2006-07-26 22:43:37 +0000'
date_gmt: '2006-07-26 22:43:37 +0000'
categories:
- ".NET"
tags: []
comments:
- id: 1087
  author: software developer
  author_email: william@geeksltd.co.uk
  author_url: http://www.geeks.ltd.uk/Services.html
  date: '2009-08-13 08:12:36 +0000'
  date_gmt: '2009-08-13 08:12:36 +0000'
  content: "Quite inspiring,\r\n\r\nCan I have a more pracrical example to see how
    it is really used in real programme\r\n\r\nThanks"
- id: 1154
  author: Sam
  author_email: scarleton@gmail.com
  author_url: http://www.miltonstreet.com
  date: '2009-10-07 20:37:01 +0000'
  date_gmt: '2009-10-07 20:37:01 +0000'
  content: "Sorry, but this doesn&rsquo;t work real well when there is a BindingList
    in a BindingList in a BindingList:\r\n\r\n    class Order\r\n    {\r\n        public
    int Qty;\r\n        public double Price;\r\n        public string Description;\r\n
    \   }\r\n\r\n    class Customer\r\n    {\r\n        public string CustomerName
    { get; set; }\r\n        public BindingList Orders { get; set; }\r\n    }\r\n\r\n
    \   class Company\r\n    {\r\n        public string CompanyName { get; set; }\r\n
    \       public BindingList Employees { get; set; }\r\n    }\r\n\r\n    class CompanyCollection
    : TypedBindingList\r\n    {\r\n        public CompanyCollection()\r\n        {\r\n
    \           this.AllowEdit = true;\r\n            this.AllowNew = true;\r\n            this.AllowRemove
    = true;\r\n        }\r\n\r\n        &#47;&#47;&#47; \r\n        &#47;&#47;&#47;
    \r\n        &#47;&#47;&#47; \r\n        public CompanyCollection(IList coll)\r\n
    \           : base(coll)\r\n        {\r\n            this.AllowEdit = true;\r\n
    \           this.AllowNew = true;\r\n            this.AllowRemove = true;\r\n
    \       }\r\n    }\r\n\r\n    static class CompanyCollectionFactory\r\n    {\r\n
    \       static private string[] products =\r\n        {\r\n            \"cats\",\"dogs\",\"tv\",\"vcr\",
    \"milk\",\"bmw z8\",\"nikon D3s\",\"cake\",\"paper\"\r\n        };\r\n\r\n        static
    public TypedBindingList Create()\r\n        {\r\n            CompanyCollection
    coll = new CompanyCollection();\r\n\r\n            coll.Add(new Company { CompanyName
    = \"A\", Employees = CreateCustomerBindingList(new string[] { \"Sam\", \"Mike\",
    \"Brian\" }) });\r\n            coll.Add(new Company { CompanyName = \"B\", Employees
    = CreateCustomerBindingList(new string[] { \"Chris\", \"George\", \"Larry\" })
    });\r\n            coll.Add(new Company { CompanyName = \"C\", Employees = CreateCustomerBindingList(new
    string[] { \"Gwen\", \"Sue\", \"Linda\" }) });\r\n            coll.Add(new Company
    { CompanyName = \"D\", Employees = CreateCustomerBindingList(new string[] { \"Kate\",
    \"Jane\", \"Marry\" }) });\r\n\r\n            return coll;\r\n        }\r\n\r\n
    \       private static BindingList CreateCustomerBindingList(string[] names)\r\n
    \       {\r\n            &#47;&#47;BindingList coll = new CustomerCollection();\r\n
    \           BindingList coll = new BindingList();\r\n\r\n            foreach (string
    s in names)\r\n            {\r\n                &#47;&#47; coll.Add(new Customer
    { CustomerName = s, Orders = CreateOrderCollection() });\r\n                coll.Add(new
    Customer { CustomerName = s, Orders = CreateOrderBindingList() });\r\n            }\r\n
    \           return coll;\r\n        }\r\n\r\n        private static BindingList
    CreateOrderBindingList()\r\n        {\r\n            BindingList coll = new BindingList();\r\n
    \           Random rnd1 = new Random();\r\n            for (int i = 0; i < 2;
    i++)\r\n            {\r\n                coll.Add(new Order\r\n                {\r\n
    \                   Qty = rnd1.Next(10) + 1,\r\n                    Description
    = products[rnd1.Next(products.Length)],\r\n                    Price = Math.Round(rnd1.NextDouble()
    * 500, 2)\r\n                });\r\n            }\r\n\r\n            return coll;\r\n
    \       }\r\n    }"
---
<p><!--start_raw--><P>A few days ago, <A href="http:&#47;&#47;www.ayende.com&#47;Blog&#47;">Ayende</A> mentioned a <A href="http:&#47;&#47;www.ayende.com&#47;Blog&#47;2006&#47;07&#47;25&#47;PolymorphicDatabindingSolutions.aspx">problem</A> he ran into while using BindingList<T> and databinding against a grid&nbsp;when the list contained a mixture of objects from classes in a class hierarchy, and proposed a solution involving the use of a custom TypeDescriptionProvider class.</P><br />
<P>I suggested that perhaps implementing ITypedList on his collection might be a solution to his problem, while being somewhat more ellegant than a custom TypeDescriptionProvider. Here's a simple implementation of ITypedList on top of BindingList<T> that's close to some code I've been using lately:</P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; COLOR: blue; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas">public</SPAN><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000> </FONT><SPAN style="COLOR: blue">class</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: teal">TypedBindingList</SPAN><FONT color=#000000><T> : </FONT><SPAN style="COLOR: teal">BindingList</SPAN><FONT color=#000000><T>, </FONT><SPAN style="COLOR: teal">ITypedList<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" &#47;><o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; COLOR: blue; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>#region</SPAN><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000> ITypedList Implementation<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47;<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; ITypedList Implementation<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47;<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; COLOR: green; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">public</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: teal">PropertyDescriptorCollection</SPAN><FONT color=#000000> GetItemProperties(</FONT><SPAN style="COLOR: teal">PropertyDescriptor</SPAN><FONT color=#000000>[] listAccessors)<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">if</SPAN><FONT color=#000000> ( listAccessors == </FONT><SPAN style="COLOR: blue">null</SPAN><FONT color=#000000> || listAccessors.Length <= 0 )<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; return the properties of items on<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; this list<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> GetTypeProperties(</FONT><SPAN style="COLOR: blue">typeof</SPAN><FONT color=#000000>(T));<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>} </FONT><SPAN style="COLOR: blue">else<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; return the properties of the specified member<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; this is needed when the list is used in master&#47;detail<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; structures to ensure the child grid can figure out<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; the types contained herein.<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">string</SPAN><FONT color=#000000> memberName = listAccessors[0].Name;<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: teal">PropertyInfo</SPAN><FONT color=#000000> pinfo = </FONT><SPAN style="COLOR: blue">typeof</SPAN><FONT color=#000000>(T).GetProperty(memberName);<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">if</SPAN><FONT color=#000000> ( pinfo != </FONT><SPAN style="COLOR: blue">null</SPAN><FONT color=#000000> )<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: teal">Type</SPAN><FONT color=#000000> type = pinfo.PropertyType;<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">if</SPAN><FONT color=#000000> ( </FONT><SPAN style="COLOR: blue">typeof</SPAN><FONT color=#000000>(</FONT><SPAN style="COLOR: teal">IList</SPAN><FONT color=#000000>).IsAssignableFrom(type) &amp;&amp; type.IsGenericType )<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; if it is a generic list, find the first generic type and<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; assume that's the type of the list contents<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: green">&#47;&#47; a hack, but it could be worse :)<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: teal">Type</SPAN><FONT color=#000000> paramType = type.GetGenericArguments()[0];<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> GetTypeProperties(paramType);<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> GetTypeProperties(type);<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: blue">null</SPAN><FONT color=#000000>;<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><o:p><FONT color=#000000>&nbsp;</FONT></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">public</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: blue">string</SPAN><FONT color=#000000> GetListName(</FONT><SPAN style="COLOR: teal">PropertyDescriptor</SPAN><FONT color=#000000>[] listAccessors)<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: blue">string</SPAN><FONT color=#000000>.Format(</FONT><SPAN style="COLOR: maroon">"List of {0}"</SPAN><FONT color=#000000>, </FONT><SPAN style="COLOR: blue">typeof</SPAN><FONT color=#000000>(T).Name);<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><o:p><FONT color=#000000>&nbsp;</FONT></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; COLOR: blue; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>#endregion</SPAN><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000> </FONT><SPAN style="COLOR: green">&#47;&#47; ITypedList Implementation<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; COLOR: green; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><o:p>&nbsp;</o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">private</SPAN><FONT color=#000000> </FONT><SPAN style="COLOR: teal">PropertyDescriptorCollection</SPAN><FONT color=#000000> GetTypeProperties(</FONT><SPAN style="COLOR: teal">Type</SPAN><FONT color=#000000> type)<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>{<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: teal">TypeDescriptionProvider</SPAN><FONT color=#000000> provider = </FONT><SPAN style="COLOR: teal">TypeDescriptor</SPAN><FONT color=#000000>.GetProvider(type);<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><SPAN style="mso-spacerun: yes"><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN style="COLOR: blue">return</SPAN><FONT color=#000000> provider.GetTypeDescriptor(type).GetProperties();<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>}<o:p></o:p></FONT></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><o:p><FONT color=#000000>&nbsp;</FONT></o:p></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 11pt; FONT-FAMILY: Consolas; mso-bidi-font-family: Consolas"><FONT color=#000000>} </FONT><SPAN style="COLOR: green">&#47;&#47; class TypedBindingList<o:p></o:p></SPAN></SPAN></P><br />
<P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-pagination: none; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"><o:p><FONT color=#000000>&nbsp;</FONT></o:p></SPAN></P><br />
<P><br />
<P>It's not pretty, but it does the trick without too much hassle. In particular, it has been very useful in binding empty collections to a third-party grid control so that it still allows you to add new records (the ITypedList implementation provides the information it needs to ensure it can handle the new record returned by IBindingList.AddNew()). Of course, you can get much fancier when implementing this stuff. <A href="http:&#47;&#47;weblogs.asp.net&#47;fbouma&#47;">Frans Bouma</A> has some pretty good articles on these kind of topics including this <A href="http:&#47;&#47;weblogs.asp.net&#47;fbouma&#47;articles&#47;115837.aspx">one</A>.</P></P><!--end_raw--></p>
