---
layout: post
status: publish
published: true
title: Simple WF Activity Validator
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 501
wordpress_url: http://winterdom.com/2006/02/simplewfactivityvalidator
date: '2006-02-17 07:13:53 +0000'
date_gmt: '2006-02-17 07:13:53 +0000'
categories:
- WinFX
- Workflow
tags: []
comments: []
---
<p><!--start_raw-->
<p>If you're building custom Windows Workflow Foundation activities, then you'll likely want to write your own custom ActivityValidator-derived classes, in order to provide your own custom validation logic to ensure activities are correctly configured at design time.</p></p>
<p>Here's a very simple sample ActivityValidator class:</p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;"><br />
<summary><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> Validator class for the MsmqReceiveActivity<o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;"></summary><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp; </font></span><span style="color: blue;">public</span><font color="#000000"> </font><span style="color: blue;">class</span><font color="#000000"> </font><span style="color: teal;">MsmqReceiveActivityValidator</span><font color="#000000"> : </font><span style="color: teal;">ActivityValidator<o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;"><br />
<summary><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> Validate the receive activity<o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;"></summary><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;">
<param name="manager"></span><span style="color: green;">Validation Manager to use</span><span style="color: gray;"></param><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;">
<param name="obj"></span><span style="color: green;">Activity instance to validate</span><span style="color: gray;"></param><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: gray;">&#47;&#47;&#47;</span><span style="color: green;"> </span><span style="color: gray;"><returns></span><span style="color: green;">Collection of validation errors</span><span style="color: gray;"></returns><o:p></o:p></span></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">public</span><font color="#000000"> </font><span style="color: blue;">override</span><font color="#000000"> </font><span style="color: teal;">ValidationErrorCollection</span><font color="#000000"> Validate(</font><span style="color: teal;">ValidationManager</span><font color="#000000"> manager, </font><span style="color: blue;">object</span><font color="#000000"> obj)<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: teal;">ValidationErrorCollection</span><font color="#000000"> errors </font><span style="color: blue;">=</span><font color="#000000"> </font><span style="color: blue;">base.</span><font color="#000000">Validate(manager, obj);<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: teal;">MsmqReceiveActivity</span><font color="#000000"> act </font><span style="color: blue;">=</span><font color="#000000"> (</font><span style="color: teal;">MsmqReceiveActivity</span><font color="#000000">)obj;<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><o:p><font color="#000000">&nbsp;</font></o:p></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">if</span><font color="#000000"> ( </font><span style="color: blue;">!</span><font color="#000000">act</font><span style="color: blue;">.</span><font color="#000000">IsBindingSet(</font><span style="color: teal;">MsmqReceiveActivity</span><span style="color: blue;">.</span><font color="#000000">QueueProperty) )<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">if</span><font color="#000000"> ( act</font><span style="color: blue;">.</span><font color="#000000">GetValue(</font><span style="color: teal;">MsmqReceiveActivity</span><span style="color: blue;">.</span><font color="#000000">QueueProperty) </font><span style="color: blue;">==</span><font color="#000000"> </font><span style="color: blue;">null</span><font color="#000000"> )<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>errors</font><span style="color: blue;">.</span><font color="#000000">Add(</font><span style="color: teal;">ValidationError</span><span style="color: blue;">.</span><font color="#000000">GetNotSetValidationError(</font><span style="color: maroon;">"Queue"</span><font color="#000000">));<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><o:p><font color="#000000">&nbsp;</font></o:p></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">if</span><font color="#000000"> ( act</font><span style="color: blue;">.</span><font color="#000000">MessageType </font><span style="color: blue;">==</span><font color="#000000"> </font><span style="color: blue;">null</span><font color="#000000"> )<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>errors</font><span style="color: blue;">.</span><font color="#000000">Add(</font><span style="color: teal;">ValidationError</span><span style="color: blue;">.</span><font color="#000000">GetNotSetValidationError(</font><span style="color: maroon;">"MessageType"</span><font color="#000000">));<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><o:p><font color="#000000">&nbsp;</font></o:p></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">if</span><font color="#000000"> ( </font><span style="color: blue;">!</span><font color="#000000">act</font><span style="color: blue;">.</span><font color="#000000">IsBindingSet(</font><span style="color: teal;">MsmqReceiveActivity</span><span style="color: blue;">.</span><font color="#000000">MessageReceivedProperty) )<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>errors</font><span style="color: blue;">.</span><font color="#000000">Add(</font><span style="color: teal;">ValidationError</span><span style="color: blue;">.</span><font color="#000000">GetNotSetValidationError(</font><span style="color: maroon;">"MessageReceived"</span><font color="#000000">));<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">return</span><font color="#000000"> errors;<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><o:p><font color="#000000">&nbsp;</font></o:p></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp; </span>} </font><span style="color: green;">&#47;&#47; class MsmqReceiveActivityValidator<o:p></o:p></span></span></p></p>
<p>
</p>
<p>This validator simply does the following checks:</p></p>
<p></p></p>
<ol>
<li>Ensures that the Queue property (which is a dependency property) of the activity is either bound to an external property, or has a direct value.</li>
<li>Ensures that the MessageType property of the activity has an actual value assigned to it.</li>
<li>Ensures that the MessageReceive property of the activity (an attached dependency property) has been explicitly bound.</li></ol>
<p>The validator is then attached to the activity via the [ActivityValidator] attribute, like this:</p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000">[</font><span style="color: teal;">SRDescription</span><font color="#000000">(</font><span style="color: maroon;">"Recv_Description"</span><font color="#000000">)]<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000">[</font><span style="color: teal;">ToolboxItem</span><font color="#000000">(</font><span style="color: blue;">typeof</span><font color="#000000">(</font><span style="color: teal;">ActivityToolboxItem</span><font color="#000000">))]<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000">[</font><span style="color: teal;">Designer</span><font color="#000000">(</font><span style="color: blue;">typeof</span><font color="#000000">(</font><span style="color: teal;">MsmqReceiveActivityDesigner</span><font color="#000000">), </font><span style="color: blue;">typeof</span><font color="#000000">(</font><span style="color: teal;">IDesigner</span><font color="#000000">))]<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000">[</font><span style="color: teal;">ToolboxBitmap</span><font color="#000000">(</font><span style="color: blue;">typeof</span><font color="#000000">(</font><span style="color: teal;">MsmqReceiveActivity</span><font color="#000000">), </font><span style="color: maroon;">"Resources.MessageQueuing.bmp"</span><font color="#000000">)]<o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="background: silver none repeat scroll 0%; font-size: 10pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; font-family: Consolas;"><font color="#000000">[</font><span style="color: teal;">ActivityValidator</span><font color="#000000">(</font><span style="color: blue;">typeof</span><font color="#000000">(</font><span style="color: teal;">MsmqReceiveActivityValidator</span><font color="#000000">))]</font></span><span style="font-size: 10pt; font-family: Consolas;"><o:p></o:p></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; color: blue; font-family: Consolas;">public</span><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"> </font><span style="color: blue;">partial</span><font color="#000000"> </font><span style="color: blue;">class</span><font color="#000000"> </font><span style="color: teal;">MsmqReceiveActivity</span><font color="#000000"> <o:p></o:p></font></span></p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-size: 10pt; font-family: Consolas;"><font color="#000000"><span style="">&nbsp;&nbsp; </span>: </font><span style="color: teal;">Activity</span><font color="#000000">, </font><span style="color: teal;">IEventActivity</span><font color="#000000">, </font><span style="color: teal;">IActivityEventListener</span><span style="color: blue;"><</span><span style="color: teal;">QueueEventArgs</span><span style="color: blue;">><o:p></o:p></span></span></p></p>
<p>&nbsp;</p><!--end_raw--></p>
