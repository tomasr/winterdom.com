---
layout: post
status: publish
published: true
title: CreateXmlInstance() with Multi-Root Schemas
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 787
wordpress_url: http://winterdom.com/2008/07/createxmlinstancewithmultirootschemas
date: '2008-07-15 20:03:54 +0000'
date_gmt: '2008-07-15 20:03:54 +0000'
categories:
- BizTalk
tags: []
comments:
- id: 533
  author: Randal van Splunteren
  author_email: Randal.van.Splunteren@hotmail.com
  author_url: http://biztalkmessages.wordpress.com
  date: '2008-07-18 02:36:57 +0000'
  date_gmt: '2008-07-18 02:36:57 +0000'
  content: |
    Funny coincendence, I blogged about this a couple of weeks ago. It took me a while to find out how to do this and didn't find anything on the net.
    see: http:&#47;&#47;biztalkmessages.wordpress.com&#47;2008&#47;06&#47;19&#47;create-message-instance-from-multiroot-xsd-using-documentspec
- id: 1520
  author: Keith Honkonen
  author_email: khonkonen@wpc-services.com
  author_url: ''
  date: '2010-07-04 18:20:14 +0000'
  date_gmt: '2010-07-04 18:20:14 +0000'
  content: Thank you, Tomas!  Worked like a charm.  Your contributions are some of
    my favorite out there.
---
<p><!--start_raw-->
<p>The <a href="http:&#47;&#47;msdn.microsoft.com&#47;en-us&#47;library&#47;microsoft.biztalk.component.interop.documentspec.aspx"><code>DocumentSpec</code></a> class in the Microsoft.BizTalk.Component.Interop namespace of the Microsoft.BizTalk.Pipelines assembly is commonly used in custom pipeline components (particularly assemblers in disassemblers) to represent a compiled BizTalk schema (a document specification).</p>
<p>This class has one interesting method: <a href="http:&#47;&#47;msdn.microsoft.com&#47;en-us&#47;library&#47;microsoft.biztalk.component.interop.documentspec.createxmlinstance.aspx"><code>CreateXmlInstance()</code></a>, which can generate an sample instance XML based on the associated schema [1]. Recently I saw a question in the <a href="http:&#47;&#47;www.biztalkgurus.com&#47;forums&#47;">BizTalkGurus</a> forum about how to use this functionality if you had a schema definition with multiple potential root elements.</p>
<p>Turns out its pretty easy, once you understand how DocumentSpec works and how Schemas are compiled into BizTalk assemblies.</p>
<p>The constructor for the <code>DocumentSpec</code> class takes two arguments: The docSpecName (schema name) and the name of the assembly it is defined in.</p>
<p>The clue to support multi-root schemas is that the docSpecName is, in reality, the namespace + type name of the class generated by the compiler when you compile the Schema into the BizTalk assembly. Each schema becomes one class in the generated code.</p>
<p>If the schema has a single root, that's the end of it; All you need to know is that <code>docSpecName == Namespace.ClassName</code>. If the schema has multiple roots, however, each root becomes a nested class within the schema class. </p>
<p>The way to select which root element to use for the sample instance generation, then, is to provide the type name of the root element nested class as to the DocumentSpec constructor instead of the name of the schema class. In other words, in this case <code>docSpecName == Namespace.SchemaClass+RootClass</code>.</p>
<p><strong>[1]</strong> One annoyance of this method is that it takes a TextWriter argument but doesn't actually write the generated XML into it; instead it returns a Stream you need to read!</p>
<div class="wlWriterSmartContent" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:4f0826f7-a84e-4b83-a4b6-7f103957b43a" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati tags: <a href="http:&#47;&#47;technorati.com&#47;tags&#47;BizTalk%20Server%202006" rel="tag">BizTalk Server 2006</a></div><!--end_raw--></p>
