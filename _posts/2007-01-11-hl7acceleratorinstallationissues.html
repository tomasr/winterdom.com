---
layout: post
status: publish
published: true
title: HL7 Accelerator Installation Issues
author:
  display_name: Tomas Restrepo
  login: tomasr
  email: tomas@winterdom.com
  url: http://winterdom.com/
author_login: tomasr
author_email: tomas@winterdom.com
author_url: http://winterdom.com/
wordpress_id: 112
wordpress_url: http://winterdom.com/2007/01/hl7acceleratorinstallationissues
date: '2007-01-11 11:59:06 +0000'
date_gmt: '2007-01-11 11:59:06 +0000'
categories:
- BizTalk
tags: []
comments:
- id: 70
  author: Roberto Ruggeri
  author_email: roberto.ruggeri@microsoft.com
  author_url: http://blogs.msdn.com/rruggeri
  date: '2007-01-12 10:21:58 +0000'
  date_gmt: '2007-01-12 10:21:58 +0000'
  content: |
    Strange behavior, I install the HL7 Accelerator on a VM all the time and I never got all those troubles. I'm happy that you were able to get it going.
- id: 71
  author: Tomas Restrepo
  author_email: tomas@winterdom.com
  author_url: http://www.winterdom.com/weblog/
  date: '2007-01-12 11:43:09 +0000'
  date_gmt: '2007-01-12 11:43:09 +0000'
  content: |
    Thanks Roberto. I'm hoping it was something in my environment as well!
- id: 1747
  author: Moe1987
  author_email: abc@abc.com
  author_url: ''
  date: '2011-07-01 13:47:45 +0000'
  date_gmt: '2011-07-01 13:47:45 +0000'
  content: We are having the same issues. Tried doing this and it seems to work.
- id: 5651
  author: Siva
  author_email: sheelu24july@yahoo.com
  author_url: ''
  date: '2012-12-30 21:34:37 +0000'
  date_gmt: '2012-12-30 21:34:37 +0000'
  content: "Hi \r\nRemoving \"checkBtsAdminUser\" row did not work for me. The installer
    finishes with no errors but does not deploy pipelines, orchestration and BTAHL7
    database. I had to modify the \"CheckBtsAdminUser\" function in the VBScript file.
    Did this in CheckBtsAdminUser function\r\nProperty(\"BTS_ADMIN_GLOBAL\")=\"1\"\r\nProperty(\"BTS_ADMIN\")=\"1\"\r\n\r\nThanks\r\nSiva"
- id: 25823
  author: tutor
  author_email: tutor@ebiz-developer.com
  author_url: http://www.ebiz-developer.com
  date: '2013-09-16 18:25:15 +0000'
  date_gmt: '2013-09-16 18:25:15 +0000'
  content: "(BizTalk 2013 &amp; Accelerator of HL7 installation is simply asking that
    you add your domain account to the BizTalk Administators group on your development
    PC.\r\n\r\nexample:\r\n\r\n1. myDevelopmentPC has the BizTalk Administrators group
    defined (as part of the BT installation)\r\n2. although I'm an administrator for
    myDomain, myDevelopmentPC needs to have my domain account ADDED to the BizTalk
    Administrators local group\r\n\r\nrob"
- id: 81730
  author: Bill
  author_email: wfeldmann@gmail.com
  author_url: ''
  date: '2014-03-11 00:50:39 +0000'
  date_gmt: '2014-03-11 00:50:39 +0000'
  content: "Sorry to bump this very old article but I am trying to install the BTAHL7
    2.0 for BizTalk 2013 and I followed all the steps here and got the HL7 accelerator
    to the point where it asks me to specifiy the account for logging services. I
    type in the account credentials for an account that is a member of every BizTalk
    group and a local administrator but it errors with the following:\r\n\r\nThe specified
    account \"localmachinename\\localaccount\" is invalid. Error code: The handle
    is invalid.\r\n\r\nAnyone know how to get past this so I can install the HL7 accelerators
    on a computer that is not joined to a domain?"
- id: 131436
  author: Marco
  author_email: mnardi@med.miami.edu
  author_url: ''
  date: '2014-04-17 19:27:32 +0000'
  date_gmt: '2014-04-17 19:27:32 +0000'
  content: "Same issue here. :(\r\nThe specified account &ldquo;localmachinename\\localaccount&rdquo;
    is invalid. Error code: The handle is invalid.\r\nWindows 2012 R2, BizTalk 2013\r\nOpened
    up a tech support ticket with Microsoft."
- id: 154404
  author: SuperMicro
  author_email: allan_au@hmsa.com
  author_url: ''
  date: '2014-08-19 21:01:11 +0000'
  date_gmt: '2014-08-19 21:01:11 +0000'
  content: "Hi.\r\n\r\nSame issue here: The specified account &ldquo;localmachinename\\localaccount&rdquo;
    is invalid. Error code: The handle is invalid.\r\n\r\nBill &#47; Marco, any luck?\r\n\r\nThis
    is for Win7 (64), SQL Server 2008 R2, VS 2010 Ulitmate, and Biztalk 2010. Thanks!"
---
<p><!--start_raw-->
<p>I had never played with the <a href="http:&#47;&#47;www.microsoft.com&#47;biztalk&#47;evaluation&#47;hl7&#47;default.mspx">HL7 Accelerator</a> for BizTalk Server 2006 before today, but for a new project I needed to have the MLLP adapter installed so that I could look at some of the adapter configuration settings in receive locations and send ports.</p>
<p>So I proceeded to hit MSDN Subscriber downloads to find the accelerator and download it, which proved harder than necessary because of the poor organization of the menu. Hint: It's not in the root "BizTalk Server Accelerators"&nbsp;node but in the one with the same node under "BizTalk Server 2006". Go figure!</p>
<p>Anyway, once I downloaded v1.3 of the accelerator I tried to install it. Unsuccessfully. I kept getting the following error message as soon as the installer started:</p><br />
<blockquote>
<p><font color="#ff0000">Error: Installation cannot be performed because the BizTalk Server has not been configured or user account is not a member of the BizTalk Server Administrators group.</font></p></blockquote>
<p>After googling for a bit I found the <a href="http:&#47;&#47;support.microsoft.com&#47;?scid=kb%3Ben-us%3B927137&amp;x=11&amp;y=9">KB article 927137</a>, which says this problem will happen because the HL7 accelerator does not support BizTalk installations configured using domain local groups and that you needed to configure BizTalk using universal groups. Alas, I was not on a domain and was just installing on a standalone Virtual Machine with BizTalk configured using machine-local groups. The KB article doesn't state that local groups are also forbidden, but it would appear that way, so keep that in mind.</p>
<p>However, I didn't give up, as I still needed to get that information and didn't want to install a domain controller around just to install the MLLP adapter. So I fired up the great <a href="http:&#47;&#47;support.microsoft.com&#47;kb&#47;255905">ORCA</a> MSI editor, opened "Microsoft BizTalk Accelerator for HL7 1.3.msi" and managed to find a way to let the setup program complete the installation. I wouldn't recommend this to anyone, but it might prove entertaining to some of you. Here's what I did:</p>
<p>First of all, I needed to&nbsp;remove the custom action that was validating the user groups at the beginning of the installer. I found it under the CustomAction table with the name CheckBtsAdminUser. Just right-click on it, select "Drop Row" and the check is gone.</p>
<p><img height="429" src="&#47;weblog&#47;content&#47;binary&#47;WindowsLiveWriter&#47;HL7AcceleratorInstallationIssues_CDD1&#47;Orca1%5B4%5D.png" width="675"> </p>
<p>I saved the installer and ran it again and this time it allowed me to go further, but I noticed it would not allow me to install all the components (including the MLLP adapter which is what I needed); they wouldn't even appear on the "features" screen. So back to Orca it was.</p>
<p>I then looked to see if any conditions where causing problem (it was reasonable), and eventually found that indeed the missing features where depending on a check in the Condition table of the MSI. So I edited them. I went through each feature and removed the "NOT BTSCOMPLETECHECK" part of the condition expression for each feature.</p>
<p><img height="433" src="&#47;weblog&#47;content&#47;binary&#47;WindowsLiveWriter&#47;HL7AcceleratorInstallationIssues_CDD1&#47;Orca2%5B4%5D.png" width="701"> </p>
<p>I saved the installer and tried again and success! All the previously missing features could now be installed. I proceeded with the installation and was able to complete it successfully, though it was a little bumpy. First I ran into an error starting the "Auditing and Logging Service". Strangely enough it was caused by a missing AuditingLoggingService.exe.config file in the "%ProgramFiles%\Microsoft BizTalk Accelerator for HL7 1.3\bin" folder; I just created an empty configuration file and it worked. </p>
<p>Right at the very end I also got an error message about not being able to create the MLLP receive location, but regardless of that the installation was complete and the MLLP adapter was indeed available. So it was a happy story in the end, as I was able to look at the stuff I needed. Thank goodness for Orca!</p>
<div class="wlWriterSmartContent" id="0767317B-992E-4b12-91E0-4F059A8CECA8:43ee65a8-9e30-441a-bf89-46207ef1fb9f" contenteditable="false" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">Technorati tags: <a href="http:&#47;&#47;technorati.com&#47;tags&#47;MSI" rel="tag">MSI</a>, <a href="http:&#47;&#47;technorati.com&#47;tags&#47;HL7" rel="tag">HL7</a>, <a href="http:&#47;&#47;technorati.com&#47;tags&#47;BizTalk%20Server" rel="tag">BizTalk Server</a>, <a href="http:&#47;&#47;technorati.com&#47;tags&#47;Orca" rel="tag">Orca</a></div><!--end_raw--></p>
